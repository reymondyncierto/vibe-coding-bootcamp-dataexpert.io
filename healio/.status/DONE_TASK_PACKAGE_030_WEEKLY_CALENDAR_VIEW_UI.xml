<?xml version='1.0' encoding='utf-8'?>
<task_packages>
    <task_package>
        <metadata>
            <id>HEALIO-030</id>
            <title>Build Weekly Calendar View for Appointment Dashboard</title>
            <domain>Appointments Frontend</domain>
            <estimated_time>45 mins</estimated_time>
            <priority>medium</priority>
            <status>DONE</status>
            <is_done>true</is_done>
            <verification_status>PASSED</verification_status>
            <dependencies>HEALIO-028, HEALIO-029</dependencies>
            <prd_reference>Feature 2 Weekly Calendar View</prd_reference>
        </metadata>
        <context>
            <background>This task implements Build Weekly Calendar View for Appointment Dashboard for Healio and is scoped as one atomic work item aligned to the PRD. It should be completed within 45 mins and leave clear evidence for follow-on tasks.</background>
            <files_involved>
                <file>healio/components/appointments/weekly-calendar.tsx</file>
                <file>healio/app/(dashboard)/appointments/page.tsx</file>
            </files_involved>
            <related_api_endpoints>
                <endpoint>GET /api/v1/appointments?date=YYYY-MM-DD</endpoint>
            </related_api_endpoints>
            <design_constraints>
                <constraint>Use Stripe-like frictionless workflows: create/edit actions should open centered modals or slide-out drawers instead of disruptive full-page forms.</constraint>
                <constraint>Use a Viedoc-style bento layout: soft floating white cards on an off-white background for dashboards and dense data views.</constraint>
                <constraint>Apply the Paper Replacement palette: app background near #F9FAFB, white cards, calm trustworthy accents (teal/sage/cerulean), and reserve red for critical alerts only.</constraint>
                <constraint>Preserve high-legibility typography: clean sans-serif (Inter/SF Pro/Halyard), bold patient names, slate-gray secondary metadata.</constraint>
                <constraint>Honor the one-click rule where applicable: keep the global + action for Add Appointment, Add Patient, and Create Invoice visible and easy to reach.</constraint>
                <constraint>Add educational empty states with clear CTAs for first-time or empty datasets.</constraint>
            </design_constraints>
        </context>
        <instruction>
            <step>Implement the scoped changes for Build Weekly Calendar View for Appointment Dashboard in the planned files (healio/components/appointments/weekly-calendar.tsx, healio/app/(dashboard)/appointments/page.tsx) while preserving the PRD-aligned project structure.</step>
            <step>Apply validation, error handling, and consistent response/UI behavior so the task output integrates cleanly with existing helpers and patterns.</step>
            <step>Wire integrations and dependencies for this task (endpoints: GET /api/v1/appointments?date=YYYY-MM-DD) and keep tenant scoping/RBAC/security expectations intact where applicable.</step>
            <step>Prefer in-context modal/drawer workflows, scannable bento cards, and educational empty states so the UI matches the requested Healio experience.</step>
            <step>Verify keyboard/focus behavior, touch target sizing, and mobile responsiveness before marking the task ready.</step>
            <validation_checklist>
                <check>Exercise the related endpoint(s): GET /api/v1/appointments?date=YYYY-MM-DD and verify response shape/status codes.</check>
                <check>Run lint/typecheck or the smallest relevant test suite for the files changed by this task.</check>
                <check>Manually verify desktop and mobile layouts plus focus/keyboard behavior for the primary interaction path.</check>
                <check>Use Chrome DevTools MCP to verify the implemented UI in-browser (desktop + mobile), check interactions, inspect console errors, and capture a validation snapshot before marking done.</check><check>Capture a screenshot or short note confirming empty/loading/error states are present where applicable.</check>
            </validation_checklist>
        </instruction>
        <output_spec>
            <artifacts>
                <artifact>Next.js page/component updates</artifact>
                <artifact>Route handler/API contract updates</artifact>
            </artifacts>
            <acceptance_criteria>
                <criterion>The deliverable for Build Weekly Calendar View for Appointment Dashboard is implemented in the referenced files and compiles without breaking adjacent modules.</criterion>
                <criterion>Task output matches the PRD scope (Feature 2 Weekly Calendar View) and remains bounded to an atomic &lt;=45-minute implementation chunk.</criterion>
                <criterion>Related endpoint behavior returns the standard success/error envelope and respects auth/public route expectations for the route class.</criterion>
                <criterion>UI states (loading, empty, error, success) are present and visually consistent with Healio bento cards, off-white background, and trust-oriented styling.</criterion>
                <criterion>Interactions are keyboard accessible and usable on mobile without disruptive navigation when a modal/drawer workflow is appropriate.</criterion>
            </acceptance_criteria>
            <commit_message>feat(healio-appointments): weekly calendar view ui</commit_message>
        </output_spec>
        <execution_tracking>
            <state>DONE</state>
            <is_done>true</is_done>
            <owner>appointments-operations</owner>
            <started_at>2026-02-24T17:44:13+08:00</started_at>
            <completed_at>2026-02-24T17:44:13+08:00</completed_at>
            <verification_status>PASSED</verification_status>
            <verification_command>npm run typecheck; Chrome DevTools MCP: /appointments (Dayâ†”Week tabs, week navigation, desktop/mobile snapshots, network GETs for 7 day columns, console check)</verification_command>
            <verification_notes>Added a weekly calendar bento view with Day/Week tabs on the appointments page. The weekly grid renders seven day columns, each using the protected appointments hook (and React Query caching/dev local auth shim from prior tasks) with explicit loading/empty/error states. During verification, an off-by-one date bug caused by UTC `toISOString()` was detected and fixed by generating local `YYYY-MM-DD` strings from local date parts; a console accessibility issue was also resolved by adding `name` attributes to Day View date/status inputs.</verification_notes>
            <evidence>
                <item>When work starts/completes, record changed files, test commands, screenshots (UI tasks), and commit/PR references here.</item>
            <item>Include Chrome DevTools MCP evidence (snapshot/screenshot reference and notes on responsive + interaction checks) here before marking frontend tasks complete.</item>
                <item>Changed files: healio/components/appointments/weekly-calendar.tsx, healio/app/(dashboard)/appointments/page.tsx (Day/Week tab switcher), healio/components/appointments/daily-schedule.tsx (added `name` attrs to eliminate browser form-field console issue), plus generated healio/tsconfig.tsbuildinfo.</item>
                <item>Typecheck: `npm run typecheck` passed after weekly date-key timezone fix and Day View input-name patch.</item>
                <item>Chrome DevTools MCP desktop verification: snapshot uid set 63 confirmed new Day/Week tab controls; snapshot uid set 66 confirmed weekly grid renders 7 day columns with correct `YYYY-MM-DD` values aligned to labels after the fix; snapshot uid set 69 confirmed success state on Tue column (3 appointments) after switching back from Day View with seeded data; snapshot uid set 70 confirmed week navigation to next week and empty-state columns.</item>
                <item>Chrome DevTools MCP mobile verification: snapshot uid set 65 and later mobile snapshot on weekly view confirmed stacked responsive layout with visible week navigation buttons and mobile nav; full-page weekly mobile screenshot saved to `/tmp/healio-healio030-weekly-mobile.png`.</item>
                <item>Console check (final clean pass after reload + Week View switch): `list_console_messages` returned no console messages. Earlier verification surfaced an expected `422` from demo-seed negative case and a form-field issue, both recorded and addressed where applicable.</item>
                <item>Network evidence (`list_network_requests` preserved): weekly API GET fan-out for This Week reqid=112-118 [all 200] and final clean pass reqid=159-165 [all 200]; next-week navigation reqid=136-142 [all 200]. Request details reqid=160 show x-healio local dev headers and `{\"success\":true,\"data\":[]}` response body for an empty day column.</item>
                <item>Implementation commit: 7caa8a8 (feat(healio-appointments): weekly calendar view ui).</item>
            </evidence>
            <completion_signal>Task is done only when state=DONE, is_done=true, completed_at is filled, verification_status=PASSED, and evidence records changed files/tests/screenshots as applicable.</completion_signal>
        </execution_tracking>
        <references>
            <agent_to_execute>Full-Stack Next.js Engineer</agent_to_execute>
            <estimated_complexity>medium</estimated_complexity>
            <blocks_on>HEALIO-028, HEALIO-029</blocks_on>
            <task_slug>WEEKLY_CALENDAR_VIEW_UI</task_slug>
        <verification_tool>Chrome DevTools MCP (required for frontend task verification)</verification_tool><verification_rules_ref>healio/.status/FRONTEND_VERIFICATION_RULES.xml</verification_rules_ref></references>
    </task_package>
</task_packages>
